plugins {
  id 'java'
  id "com.github.node-gradle.node" version "3.2.1"
}

processResources {
  from('dist') {
    into 'META-INF/resources/webapp'
  }
}

task buildFrontend() {
  dependsOn(npm_run_generate)
}

Collection getListOfFolders(String dir, String pattern) {
  file(dir).listFiles({ file -> !file.isFile() && file.name ==~ pattern } as FileFilter)
}

clean.doFirst {
  delete getListOfFolders('./', /dist/)
}

node {
  version = '16.14.2'
  download = true
}

processResources.dependsOn(buildFrontend)
